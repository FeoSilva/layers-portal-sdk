!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";var r=function(e){var t,n=0;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n.toString(16)},i=/^LAYERS:(-?[0-9a-f]+):(.+)$/;function o(){}o.prototype.serialize=function(e){var t=JSON.stringify(e);return`LAYERS:${r(t)}:${t}`},o.prototype.deserialize=function(e){var t=i.exec(e);if(!t)throw new Error("Malformed message");var n=t[1],o=t[2];if(r(o)!==n)throw new Error("Corrupted message");return JSON.parse(o)};var s=new o;function a(e){this.pendingMessages={},this.errorListener=e.errorListener||function(){},this.requestListener=e.requestListener||function(){},this.targetWindow=e.targetWindow||window.parent,this.targetOrigin=e.targetOrigin||"*",this.version=e.version||"2.0.2",this._isInitialized=!1}a.prototype.init=function(){this._isInitialized||(this.destroy(),this._bindedEventHandler=this._eventHandler.bind(this),window.addEventListener?window.addEventListener("message",this._bindedEventHandler,!1):window.attachEvent&&window.attachEvent("onmessage",this._bindedEventHandler),this._isInitialized=!0)},a.prototype.destroy=function(){this._bindedEventHandler&&(window.removeEventListener("remove",this._bindedEventHandler,!1),this._bindedEventHandler=null)},a.prototype.send=function(e,t,n){return n=n||3e4,new Promise((r,i)=>{var o=~~(Math.random()*(1<<30)),s=setTimeout(()=>{i(new Error(`Message ${o} timed out!`))},n);this.pendingMessages[o]={resolve:r,reject:i,timeoutId:s};var a={id:o,method:e,payload:t,version:this.version,type:"request"};this._postMessage(this.targetWindow,a,this.targetOrigin)})},a.prototype._postMessage=function(e,t,n){var r=s.serialize(t);e.postMessage(r,n)},a.prototype._eventHandler=function(e){var t;try{t=s.deserialize(e.data)}catch(e){return}if(t.id)switch(t.type){case"response":return void this._handleResponseMessage(t);case"error":return void this._handleErrorMessage(t);case"request":return void this._handleRequestMessage(t,e.source);default:this.errorListener(new Error(`Message received with unknown type "${t.type}"!`))}else this.errorListener(new Error("Message received without id!"))},a.prototype._handleResponseMessage=function(e){var t=e.id,n=e.payload;if(t in this.pendingMessages){var r=this.pendingMessages[t],i=r.resolve,o=r.timeoutId;clearTimeout(o),delete this.pendingMessages[t],i(n)}},a.prototype._handleErrorMessage=function(e){var t=e.id,n=new Error(e.payload);if(t in this.pendingMessages){var r=this.pendingMessages[t],i=r.reject,o=r.timeoutId;clearTimeout(o),delete this.pendingMessages[t],i(n)}},a.prototype._handleRequestMessage=function(e,t){var n=e.id,r=e.method,i=e.payload,o=this.requestListener(r,i);Promise.resolve(o).then(e=>{this._postMessage(t,{id:n,payload:e,version:this.version,type:"response"},"*")}).catch(e=>{this._postMessage(t,{id:n,payload:e.message,version:this.version,type:"error"},"*")})};t.a=a},,function(e,t,n){"use strict";function r(){this.initialized=!1}n.r(t),r.prototype._ensureInit=function(){return new Promise((e,t)=>{this.initialized||this._init&&Promise.resolve(this._init()).then(()=>{this.initialized=!0,e()}),e()})},r.prototype.handle=function(e,t){return new Promise((n,r)=>{var i=this[e];i||r(new Error(`Method ${e} not found.`)),Promise.resolve(i.bind(this)(t)).then(n).catch(r)})};var i=r;function o(){}o.prototype=new i,o.prototype._init=function(){},o.prototype.boot=function(e){};var s=o,a=n(0);function u(){}u.prototype=new i,u.prototype._init=function(){if(!window)throw new Error('Can not use UI module without "window"');this.parentCommunication=new a.a({requestListener:this._requestListener.bind(this),errorListener:this._errorListener.bind(this)}),this.parentCommunication.init()},u.prototype._requestListener=function(e,t){var n=this[e];if(!n)throw new Error(`Unknown request method ${e}`);return n.bind(this)(t)},u.prototype._errorListener=function(e){console.error("Error listener:",e)},u.prototype.createPost=function(e){return this.parentCommunication.send("createPost",e)},u.prototype.close=function(e){return this.parentCommunication.send("close",e)};var d=u;function p(){}p.prototype=new i,p.prototype.setup=function(e){};var h=p,c={root:new s,ui:new d,api:new h};if(window.Layers&&Layers.q){for(var f of Layers.q){v(f[0],f[1],f[2],f[3],f[4])}delete Layers.q,Layers=function(e,t){return l("root",e,t)},Layers.ui=function(e,t){return l("ui",e,t)},Layers.api=function(e,t){return l("api",e,t)}}function l(e,t,n){return new Promise((r,i)=>{v(r,i,e,t,n)})}function v(e,t,n,r,i){if(0===r.indexOf("_"))throw new Error(`Can not run private method ${r}!`);(function(e){return new Promise((t,n)=>{var r=c[e];r||n(new Error(`Module ${e} not found.`)),r._ensureInit().then(()=>{t(r)})})})(n).then(n=>{n.handle(r,i).then(e).catch(t)})}}]);